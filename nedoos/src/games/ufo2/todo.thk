XM11.TIF - город-порт

где графика героев?



;фикс обработчика прерывания (не сохранял Z)
;иногда вылетал при скролл вниз, потом курсор вверх (иногда до этого запарывался курсор и атрибут da2d, один раз было d880=f7) (ещё запарывало 0026, 002b, т.к. (BHL)=(AHL)=002b)
6f82
CANF_V	LD HL,(CANF_B) ;индикация in line of fire
	LD H,L
	CALL MEM7
	LD (ATR+557),HL
	JP PT128


почему графика ландшафта запорота?


;0-x,1-y,2-ЭТАЖ,3-направление,4-Paca,5-наш/не наш,6-VISION,7-N спрайта внизу
;8-имя,9-ранг,10-защита,11-TU,12-EN,13-HEALTH,14-WOUND,15-MORAL,16-Меткость
;(17-20)-ОРУЖИЕ 1-4, (21-24)-патроны 1-4
;25-текущ.оружие, 26-FREEZE
;27-TUold, 28-ENold, 29-HEALTHold, 30-peзерв, 31-MORALold

xgamedat.asm:
AQNAVT	DEFB   0;ИМЯ(0-нет)
	DEFB   1;ранг(0-7)
	DEFB   2 ;защита(0-нет,1,2,3)
	DEFB   3;Time Units
	DEFB   4;Energy
	DEFB   5;Health
	DEFB   6;Wound
	DEFB   7;Moral Level
	DEFB   8;Precision
	DEFB   9;Gun 1 (255-no)
	DEFB   10;Gun 2
	DEFB   11;Gun 3
	DEFB   12;Gun 4
	DEFB   13;Дни до след. звания
	DEFB 	0;--
	DEFB 	0;--
	DEFS   9*16,0


;содержимое страниц
;СТРАНИЦЫ: c #C000
;0: #C000:
;1: #C000:T(256<),TWCMPR(256),WORDS,MENUS,PEDIA,NAMES
;2: *main*
;3: #C000:xSprites,xSHIP,xUFO
;4: #C000:xHERO(12k=8*16*96),#F000:xDIE(768),#F300:xBOOM(768),#F600
;5: *main*
;6: *swap*
;7: #C000:SCR,#D800:ATR,#DB00:

как будет лежать графика тайлов для 16c (один ряд с автомаской = 4096):
pg13:
c000: истребитель (0,1,2-15)
d000: НЛО (16-...)

pg14:
c000: ландшафт (64-95)
временно e000: xHERO


xlib.asm: /содержимое pg6/
;8F80-xCONV(128)
;9000-теневой экран(6k)
;A800-теневые атрибуты(768)  (128-буф1)
;AB00-MAN+ALIEN(1024) /объекты/
;AF80-vSIZE(128) /что-то для пересчёта номеров тайлов в адреса/
;AF00-xATR(128) /загрузка ufoaf00 и ufopg6 не помогает/
;B000-истребитель(2k) (0,1,2-15) /gfx - показывается правильно/ ;края карты берутся из графики корабля (b0a0..b0bf)
;B800-НЛО(6k) (16-63) /gfx - показывается правильно/
;D000-ландшафт(4k) (64-95) /gfx/
;E000-1й этаж(4k) /карта?/
;F000-2й этаж(4k) /карта нижнего этажа?/

;CПРАЙТЫ: 0-fill 2й этаж;1-fill 1й этаж
;2-15-истребитель(2-vSIZE<4)
;96-127-стоит герой(0-31)

SCR	EQU	#C000
ATR	EQU	#D800
DSCR	EQU	#9000
DATR	EQU	#A800
MAN	EQU     #AB00
ALIEN   EQU	MAN+320
TMP	EQU	DSCR
xATR	EQU     #AF00
vSIZE	EQU	#AF80
xCONV	EQU	#8F80



как замочить тарелку:
:E031 HISPWR поставить 1 (при CHEATS - кнопка E)

висит на COMBAT во время размещения врагов (xlik.asm: Ap8)

куда и что грузим для стратегии?
xm19.dat
XL19.LND

db00 (pg7)
9000
~9383
9000
...
~fxxx
~e5xx


почему ищет клетку с кодом 2, а её нет?

даже если загрузить h:\map с e000 (рабочая карта)
и почему запорота графика уровня?

rem mhmt -mlz ZX_DISC\xm2.dat ufo2\xm2.dat > nul
rem mhmt -mlz ZX_DISC\xm3.dat ufo2\xm3.dat > nul
rem mhmt -mlz ZX_DISC\xm4.dat ufo2\xm4.dat > nul
rem mhmt -mlz ZX_DISC\xm5.dat ufo2\xm5.dat > nul
rem mhmt -mlz ZX_DISC\xm6.dat ufo2\xm6.dat > nul
rem mhmt -mlz ZX_DISC\xm7.dat ufo2\xm7.dat > nul
rem mhmt -mlz ZX_DISC\xm8.dat ufo2\xm8.dat > nul
rem mhmt -mlz ZX_DISC\xm9.dat ufo2\xm9.dat > nul
rem mhmt -mlz ZX_DISC\xm10.dat ufo2\xm10.dat > nul
rem mhmt -mlz ZX_DISC\xm11.dat ufo2\xm11.dat > nul
rem mhmt -mlz ZX_DISC\xm12.dat ufo2\xm12.dat > nul
rem mhmt -mlz ZX_DISC\xm13.dat ufo2\xm13.dat > nul
rem mhmt -mlz ZX_DISC\xm14.dat ufo2\xm14.dat > nul
rem mhmt -mlz ZX_DISC\xm15.dat ufo2\xm15.dat > nul
rem mhmt -mlz ZX_DISC\xm16.dat ufo2\xm16.dat > nul
rem mhmt -mlz ZX_DISC\xm17.dat ufo2\xm17.dat > nul
rem mhmt -mlz ZX_DISC\xm18.dat ufo2\xm18.dat > nul
rem mhmt -mlz ZX_DISC\xm19.dat ufo2\xm19.dat > nul
rem mhmt -mlz ZX_DISC\xm20.dat ufo2\xm20.dat > nul
